{"ast":null,"code":"var _jsxFileName = \"/Users/ttc/Desktop/QLDA_QLKS_django_react/react-website/src/components/booking/PaymentResult.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { api } from '../utils/ApiFunctions';\nimport Cookies from 'react-cookies';\nconst PaymentResult = () => {\n  const location = useLocation();\n  const [paymentResult, setPaymentResult] = useState(null);\n  const csrftoken = Cookies.load('csrftoken');\n  const updateBookingStatus = async (bookingId, status) => {\n    try {\n      await api.post(`/hotel/booking/${bookingId}/change-status/`, {\n        payment_status: status\n      }, {\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrftoken\n        }\n      });\n    } catch (error) {\n      console.error('Error updating booking status:', error);\n    }\n  };\n  useEffect(() => {\n    const queryParams = new URLSearchParams(location.search);\n    const result = queryParams.get('vnp_TransactionStatus');\n    if (result) {\n      const isSuccess = result === '00';\n      setPaymentResult({\n        title: result === '00' ? \"Payment Success\" : \"Payment Failure\",\n        result: result === '00' ? \"Success\" : \"Failed\",\n        orderId: queryParams.get('vnp_TxnRef'),\n        amount: queryParams.get('vnp_Amount'),\n        orderDesc: queryParams.get('vnp_OrderInfo'),\n        vnpTransactionNo: queryParams.get('vnp_TransactionNo'),\n        vnpResponseCode: queryParams.get('vnp_ResponseCode'),\n        msg: queryParams.get('vnp_Message') || \"No message provided\"\n      });\n      const bookingId = localStorage.getItem('bookingId');\n      if (isSuccess && bookingId) {\n        updateBookingStatus(bookingId, 'paid');\n      }\n    }\n  }, [location.search]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"payment-result-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }\n  }, paymentResult ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 21\n    }\n  }, paymentResult.title), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"payment-result-details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 28\n    }\n  }, \"Transaction Result:\"), \" \", paymentResult.result), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 28\n    }\n  }, \"Order ID:\"), \" \", paymentResult.orderId), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 28\n    }\n  }, \"Amount:\"), \" \", paymentResult.amount, \" VND\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 28\n    }\n  }, \"Order Description:\"), \" \", paymentResult.orderDesc), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 28\n    }\n  }, \"VNPay Transaction No:\"), \" \", paymentResult.vnpTransactionNo), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 28\n    }\n  }, \"VNPay Response Code:\"), \" \", paymentResult.vnpResponseCode), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 28\n    }\n  }, \"Message:\"), \" \", paymentResult.msg))) : /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }\n  }, \"Loading payment result...\"));\n};\nexport default PaymentResult;","map":{"version":3,"names":["React","useEffect","useState","useLocation","api","Cookies","PaymentResult","location","paymentResult","setPaymentResult","csrftoken","load","updateBookingStatus","bookingId","status","post","payment_status","headers","error","console","queryParams","URLSearchParams","search","result","get","isSuccess","title","orderId","amount","orderDesc","vnpTransactionNo","vnpResponseCode","msg","localStorage","getItem","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/ttc/Desktop/QLDA_QLKS_django_react/react-website/src/components/booking/PaymentResult.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { api } from '../utils/ApiFunctions'; \nimport Cookies from 'react-cookies';\n\nconst PaymentResult = () => {\n    const location = useLocation();\n\n    const [paymentResult, setPaymentResult] = useState(null);\n    const csrftoken = Cookies.load('csrftoken');\n\n\n    const updateBookingStatus = async (bookingId, status) => {\n        try {\n            await api.post(`/hotel/booking/${bookingId}/change-status/`, {\n                payment_status: status\n            }, {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-CSRFToken': csrftoken\n                }\n            });\n        } catch (error) {\n            console.error('Error updating booking status:', error);\n        }\n    };\n\n    \n\n    useEffect(() => {\n        const queryParams = new URLSearchParams(location.search);\n        \n        const result = queryParams.get('vnp_TransactionStatus');\n\n        if (result) {\n            const isSuccess = result === '00';\n            setPaymentResult({\n                title: result === '00' ? \"Payment Success\" : \"Payment Failure\",\n                result: result === '00' ? \"Success\" : \"Failed\",\n                orderId: queryParams.get('vnp_TxnRef'),\n                amount: queryParams.get('vnp_Amount'),\n                orderDesc: queryParams.get('vnp_OrderInfo'),\n                vnpTransactionNo: queryParams.get('vnp_TransactionNo'),\n                vnpResponseCode: queryParams.get('vnp_ResponseCode'),\n                msg: queryParams.get('vnp_Message') || \"No message provided\"\n            });\n\n            const bookingId = localStorage.getItem('bookingId');\n            if (isSuccess && bookingId) {\n                updateBookingStatus(bookingId, 'paid');\n            }\n        }\n    }, [location.search]);\n\n    return (\n        <div className=\"payment-result-container\">\n            {paymentResult ? (\n                <div>\n                    <h3>{paymentResult.title}</h3>\n                    <div className=\"payment-result-details\">\n                        <p><strong>Transaction Result:</strong> {paymentResult.result}</p>\n                        <p><strong>Order ID:</strong> {paymentResult.orderId}</p>\n                        <p><strong>Amount:</strong> {paymentResult.amount} VND</p>\n                        <p><strong>Order Description:</strong> {paymentResult.orderDesc}</p>\n                        <p><strong>VNPay Transaction No:</strong> {paymentResult.vnpTransactionNo}</p>\n                        <p><strong>VNPay Response Code:</strong> {paymentResult.vnpResponseCode}</p>\n                        <p><strong>Message:</strong> {paymentResult.msg}</p>\n                    </div>\n                </div>\n            ) : (\n                <p>Loading payment result...</p>\n            )}\n        </div>\n    );\n};\n\nexport default PaymentResult;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,GAAG,QAAQ,uBAAuB;AAC3C,OAAOC,OAAO,MAAM,eAAe;AAEnC,MAAMC,aAAa,GAAGA,CAAA,KAAM;EACxB,MAAMC,QAAQ,GAAGJ,WAAW,CAAC,CAAC;EAE9B,MAAM,CAACK,aAAa,EAAEC,gBAAgB,CAAC,GAAGP,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAMQ,SAAS,GAAGL,OAAO,CAACM,IAAI,CAAC,WAAW,CAAC;EAG3C,MAAMC,mBAAmB,GAAG,MAAAA,CAAOC,SAAS,EAAEC,MAAM,KAAK;IACrD,IAAI;MACA,MAAMV,GAAG,CAACW,IAAI,CAAC,kBAAkBF,SAAS,iBAAiB,EAAE;QACzDG,cAAc,EAAEF;MACpB,CAAC,EAAE;QACCG,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,aAAa,EAAEP;QACnB;MACJ,CAAC,CAAC;IACN,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IAC1D;EACJ,CAAC;EAIDjB,SAAS,CAAC,MAAM;IACZ,MAAMmB,WAAW,GAAG,IAAIC,eAAe,CAACd,QAAQ,CAACe,MAAM,CAAC;IAExD,MAAMC,MAAM,GAAGH,WAAW,CAACI,GAAG,CAAC,uBAAuB,CAAC;IAEvD,IAAID,MAAM,EAAE;MACR,MAAME,SAAS,GAAGF,MAAM,KAAK,IAAI;MACjCd,gBAAgB,CAAC;QACbiB,KAAK,EAAEH,MAAM,KAAK,IAAI,GAAG,iBAAiB,GAAG,iBAAiB;QAC9DA,MAAM,EAAEA,MAAM,KAAK,IAAI,GAAG,SAAS,GAAG,QAAQ;QAC9CI,OAAO,EAAEP,WAAW,CAACI,GAAG,CAAC,YAAY,CAAC;QACtCI,MAAM,EAAER,WAAW,CAACI,GAAG,CAAC,YAAY,CAAC;QACrCK,SAAS,EAAET,WAAW,CAACI,GAAG,CAAC,eAAe,CAAC;QAC3CM,gBAAgB,EAAEV,WAAW,CAACI,GAAG,CAAC,mBAAmB,CAAC;QACtDO,eAAe,EAAEX,WAAW,CAACI,GAAG,CAAC,kBAAkB,CAAC;QACpDQ,GAAG,EAAEZ,WAAW,CAACI,GAAG,CAAC,aAAa,CAAC,IAAI;MAC3C,CAAC,CAAC;MAEF,MAAMX,SAAS,GAAGoB,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;MACnD,IAAIT,SAAS,IAAIZ,SAAS,EAAE;QACxBD,mBAAmB,CAACC,SAAS,EAAE,MAAM,CAAC;MAC1C;IACJ;EACJ,CAAC,EAAE,CAACN,QAAQ,CAACe,MAAM,CAAC,CAAC;EAErB,oBACItB,KAAA,CAAAmC,aAAA;IAAKC,SAAS,EAAC,0BAA0B;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GACpClC,aAAa,gBACVR,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACI1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAKlC,aAAa,CAACkB,KAAU,CAAC,eAC9B1B,KAAA,CAAAmC,aAAA;IAAKC,SAAS,EAAC,wBAAwB;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACnC1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAAG1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAQ,qBAA2B,CAAC,KAAC,EAAClC,aAAa,CAACe,MAAU,CAAC,eAClEvB,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAAG1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAQ,WAAiB,CAAC,KAAC,EAAClC,aAAa,CAACmB,OAAW,CAAC,eACzD3B,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAAG1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAQ,SAAe,CAAC,KAAC,EAAClC,aAAa,CAACoB,MAAM,EAAC,MAAO,CAAC,eAC1D5B,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAAG1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAQ,oBAA0B,CAAC,KAAC,EAAClC,aAAa,CAACqB,SAAa,CAAC,eACpE7B,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAAG1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAQ,uBAA6B,CAAC,KAAC,EAAClC,aAAa,CAACsB,gBAAoB,CAAC,eAC9E9B,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAAG1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAQ,sBAA4B,CAAC,KAAC,EAAClC,aAAa,CAACuB,eAAmB,CAAC,eAC5E/B,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBAAG1C,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAQ,UAAgB,CAAC,KAAC,EAAClC,aAAa,CAACwB,GAAO,CAClD,CACJ,CAAC,gBAENhC,KAAA,CAAAmC,aAAA;IAAAE,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAG,2BAA4B,CAElC,CAAC;AAEd,CAAC;AAED,eAAepC,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module"}